// Code generated by winrt-go-gen. DO NOT EDIT.

//go:build windows

//nolint:all
package foundation

import (
	"syscall"
	"unsafe"

	"github.com/go-ole/go-ole"
)

const SignatureWwwFormUrlDecoder string = "rc(Windows.Foundation.WwwFormUrlDecoder;{d45a0451-f225-4542-9296-0e1df5d254df})"

type WwwFormUrlDecoder struct {
	ole.IUnknown
}

func (impl *WwwFormUrlDecoder) GetFirstValueByName(name string) (string, error) {
	itf := impl.MustQueryInterface(ole.NewGUID(GUIDiWwwFormUrlDecoderRuntimeClass))
	defer itf.Release()
	v := (*iWwwFormUrlDecoderRuntimeClass)(unsafe.Pointer(itf))
	return v.GetFirstValueByName(name)
}

const GUIDiWwwFormUrlDecoderRuntimeClass string = "d45a0451-f225-4542-9296-0e1df5d254df"
const SignatureiWwwFormUrlDecoderRuntimeClass string = "{d45a0451-f225-4542-9296-0e1df5d254df}"

type iWwwFormUrlDecoderRuntimeClass struct {
	ole.IInspectable
}

type iWwwFormUrlDecoderRuntimeClassVtbl struct {
	ole.IInspectableVtbl

	GetFirstValueByName uintptr
}

func (v *iWwwFormUrlDecoderRuntimeClass) VTable() *iWwwFormUrlDecoderRuntimeClassVtbl {
	return (*iWwwFormUrlDecoderRuntimeClassVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *iWwwFormUrlDecoderRuntimeClass) GetFirstValueByName(name string) (string, error) {
	var outHStr ole.HString
	nameHStr, err := ole.NewHString(name)
	if err != nil {
		return "", err
	}
	hr, _, _ := syscall.SyscallN(
		v.VTable().GetFirstValueByName,
		uintptr(unsafe.Pointer(v)),        // this
		uintptr(nameHStr),                 // in string
		uintptr(unsafe.Pointer(&outHStr)), // out string
	)

	if hr != 0 {
		return "", ole.NewError(hr)
	}

	out := outHStr.String()
	ole.DeleteHString(outHStr)
	return out, nil
}

const GUIDiWwwFormUrlDecoderRuntimeClassFactory string = "5b8c6b3d-24ae-41b5-a1bf-f0c3d544845b"
const SignatureiWwwFormUrlDecoderRuntimeClassFactory string = "{5b8c6b3d-24ae-41b5-a1bf-f0c3d544845b}"

type iWwwFormUrlDecoderRuntimeClassFactory struct {
	ole.IInspectable
}

type iWwwFormUrlDecoderRuntimeClassFactoryVtbl struct {
	ole.IInspectableVtbl

	WwwFormUrlDecoderCreateWwwFormUrlDecoder uintptr
}

func (v *iWwwFormUrlDecoderRuntimeClassFactory) VTable() *iWwwFormUrlDecoderRuntimeClassFactoryVtbl {
	return (*iWwwFormUrlDecoderRuntimeClassFactoryVtbl)(unsafe.Pointer(v.RawVTable))
}

func WwwFormUrlDecoderCreateWwwFormUrlDecoder(query string) (*WwwFormUrlDecoder, error) {
	inspectable, err := ole.RoGetActivationFactory("Windows.Foundation.WwwFormUrlDecoder", ole.NewGUID(GUIDiWwwFormUrlDecoderRuntimeClassFactory))
	if err != nil {
		return nil, err
	}
	v := (*iWwwFormUrlDecoderRuntimeClassFactory)(unsafe.Pointer(inspectable))

	var out *WwwFormUrlDecoder
	queryHStr, err := ole.NewHString(query)
	if err != nil {
		return nil, err
	}
	hr, _, _ := syscall.SyscallN(
		v.VTable().WwwFormUrlDecoderCreateWwwFormUrlDecoder,
		0,                             // this is a static func, so there's no this
		uintptr(queryHStr),            // in string
		uintptr(unsafe.Pointer(&out)), // out WwwFormUrlDecoder
	)

	if hr != 0 {
		return nil, ole.NewError(hr)
	}

	return out, nil
}
